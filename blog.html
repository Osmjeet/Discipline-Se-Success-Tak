<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blogs ‚Äî Jeet S Singh (Author of Discipline Se Success Tak)</title>
  <meta name="description" content="Read inspiring blogs by Jeet S Singh, Author of 'Discipline Se Success Tak'. Series-wise, search, preview and read more (loads posts from posts/)." />
  <style>
    :root{
      --bg:#f7fbfa; --card:#ffffff; --accent:#0bb39a; --accent-dark:#06664f;
      --muted:#6b7a75; --maxw:1100px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background:var(--bg); color:#123532; -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    nav{background:var(--accent-dark);padding:12px 18px}
    nav .menu{max-width:var(--maxw);margin:auto;display:flex;align-items:center;gap:14px;flex-wrap:wrap}
    nav a{color:#fff;text-decoration:none;font-weight:700}
    nav .right{margin-left:auto;display:flex;gap:10px;align-items:center}
    .wrap{max-width:var(--maxw);margin:26px auto;padding:18px}
    header h1{margin:8px 0 6px;font-size:28px;color:var(--accent-dark);text-align:center}
    .top-controls{display:flex;gap:12px;align-items:center;justify-content:center;margin:18px 0;flex-wrap:wrap}
    .search{display:flex;gap:8px}
    input[type="search"]{padding:10px 12px;border-radius:10px;border:1px solid #e6f2ee;font-size:15px;width:340px;max-width:80%}
    button.icon-btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
    .series{margin-top:18px}
    .series-header{display:flex;align-items:center;gap:12px;cursor:pointer;padding:12px;border-radius:12px;background:linear-gradient(90deg,#f1fbf8,#ffffff);border:1px solid #e6f7f0}
    .series-header h2{margin:0;font-size:18px;color:var(--accent-dark)}
    .series-desc{color:var(--muted);font-size:14px;margin-top:6px}
    .blogs-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:18px;margin-top:14px}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 8px 26px rgba(6,20,18,0.06);border:1px solid #eef6f2;min-height:160px;display:flex;flex-direction:column;justify-content:space-between}
    .card h3{margin:0 0 8px;font-size:17px;color:#044b3f}
    .card p{margin:0 0 12px;color:#234b44;line-height:1.6;flex:1}
    .card .meta{font-size:13px;color:var(--muted);margin-bottom:8px}
    .card .actions{display:flex;gap:8px;align-items:center}
    .btn{padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .btn-read{background:var(--accent);color:#fff}
    .btn-more{background:transparent;border:2px solid #e6f2ee;color:var(--accent-dark)}
    .collapse{margin-top:12px;padding:14px;background:#fbfffb;border-radius:10px;border:1px solid #e6f7ef;display:none}
    .centered{max-width:820px;margin:0 auto;text-align:left}
    .writtenby{margin-top:12px;font-style:italic;color:var(--muted);font-weight:600}
    footer{margin:28px 0;text-align:center;color:var(--muted);font-size:14px}
    /* responsive tweaks */
    @media(max-width:880px){
      .blogs-row{grid-template-columns:1fr}
      .top-controls{flex-direction:column}
      nav .menu{gap:8px}
    }
  </style>
</head>
<body>
  <nav>
    <div class="menu">
      <a href="index.html">üè† Home</a>
      <a href="author.html">üë§ Author</a>
      <a href="blog.html">üìù Blogs</a>
      <div class="right">
        <!-- optional extra nav items -->
      </div>
    </div>
  </nav>

  <main class="wrap">
    <header>
      <h1>üìñ Blogs by Jeet S Singh</h1>
      <div style="text-align:center;color:var(--muted);font-size:15px">Author of ‚ÄúDiscipline Se Success Tak‚Äù</div>
    </header>

    <div class="top-controls">
      <div class="search">
        <input id="q" type="search" placeholder="Search by title or preview ‚Äî type & press Enter">
        <button id="clear" class="icon-btn" title="Clear">Clear</button>
      </div>
      <div>
        <button id="expandAll" class="icon-btn">Expand All</button>
        <button id="collapseAll" class="icon-btn" style="background:#f0f0f0;color:#074a3f">Collapse All</button>
      </div>
    </div>

    <div id="series-container" class="centered">
      <!-- series injected here -->
      <div style="text-align:center;color:var(--muted);margin-top:18px" id="status">Loading blogs‚Ä¶</div>
    </div>

    <footer>¬© 2025 Jeet S. Singh ‚Äî Discipline ‚Ä¢ Faith ‚Ä¢ Success</footer>
  </main>

  <script>
    // Utility: sanitize title -> id
    function idify(s){ return 's_'+s.replace(/\s+/g,'_').replace(/[^\w\-]/g,'').toLowerCase(); }

    // Load posts.json and render
    async function init(){
      const container = document.getElementById('series-container');
      const status = document.getElementById('status');
      try{
        const res = await fetch('posts.json');
        if(!res.ok) throw new Error('posts.json not found');
        const data = await res.json();
        status.style.display='none';

        // data may have .series array
        const seriesList = data.series || data;

        seriesList.forEach((series, sidx) => {
          const seriesEl = document.createElement('section');
          seriesEl.className = 'series';
          // header
          const hdr = document.createElement('div');
          hdr.className = 'series-header';
          hdr.tabIndex = 0;
          hdr.setAttribute('role','button');

          const h2 = document.createElement('h2');
          h2.textContent = series.name || `Series ${sidx+1}`;
          hdr.appendChild(h2);

          const desc = document.createElement('div');
          desc.className = 'series-desc';
          desc.textContent = series.description || '';
          
          // toggle caret
          const caret = document.createElement('div');
          caret.style.marginLeft='auto';
          caret.style.color='var(--muted)';
          caret.textContent = '‚ñæ';
          hdr.appendChild(caret);

          seriesEl.appendChild(hdr);
          if(desc.textContent) seriesEl.appendChild(desc);

          // blogs grid (initially hidden)
          const grid = document.createElement('div');
          grid.className = 'blogs-row';
          grid.style.display='none';
          grid.dataset.series = sidx;

          // create each blog card
          (series.blogs || []).forEach((b, idx) => {
            const card = document.createElement('article');
            card.className = 'card';
            card.dataset.title = b.title || '';
            card.dataset.preview = b.preview || '';
            card.dataset.file = b.file || '';
            card.dataset.id = (series.id||sidx)+'_'+(b.id||idx+1);

            const h3 = document.createElement('h3'); h3.textContent = b.title;
            const meta = document.createElement('div'); meta.className='meta'; meta.textContent = `Series ${series.id || (sidx+1)} ‚Ä¢ Blog ${b.id || (idx+1)}`;
            const p = document.createElement('p'); p.textContent = b.preview;

            const actions = document.createElement('div'); actions.className='actions';
            const readBtn = document.createElement('button'); readBtn.className='btn btn-read'; readBtn.textContent='Read More ‚Üí';
            const moreBtn = document.createElement('button'); moreBtn.className='btn btn-more'; moreBtn.textContent='Open in new';

            // collapse area
            const collapse = document.createElement('div'); collapse.className='collapse';
            collapse.id = 'post_' + card.dataset.id;

            // attach read handler
            readBtn.addEventListener('click', async ()=>{
              const file = card.dataset.file;
              if(collapse.style.display==='block'){ collapse.style.display='none'; readBtn.textContent='Read More ‚Üí'; return; }
              // show
              collapse.style.display='block';
              readBtn.textContent='Hide';
              if(!collapse.dataset.loaded){
                collapse.innerHTML = '<em>Loading content‚Ä¶</em>';
                try{
                  const r = await fetch(file);
                  if(!r.ok) throw new Error('file not found');
                  const html = await r.text();
                  // simple dedupe: remove duplicate written-by if present before appending our signature
                  let content = html;
                  // sanitize: if file includes full html document body, try to extract body inner HTML
                  const bodyMatch = content.match(/<body[^>]*>([\s\S]*?)<\/body>/i);
                  if(bodyMatch) content = bodyMatch[1];
                  // if "Written by" not present, append small signature
                  if(!/written by/i.test(content) && !/author of/i.test(content.toLowerCase())){
                    content += `<p class="writtenby">‚úçÔ∏è Written by <strong>Jeet S Singh</strong>, Author of <a href="https://www.amazon.in/dp/B0FPHVNRBK" target="_blank">‚ÄúDiscipline Se Success Tak‚Äù</a></p>`;
                  }
                  collapse.innerHTML = content;
                  collapse.dataset.loaded = 'true';
                }catch(err){
                  collapse.innerHTML = '<em>Error loading blog content.</em>';
                }
              }
            });

            // open in new tab (directly to post file)
            moreBtn.addEventListener('click', ()=> {
              const file = card.dataset.file;
              if(file) window.open(file, '_blank');
            });

            actions.appendChild(readBtn);
            actions.appendChild(moreBtn);

            card.appendChild(h3);
            card.appendChild(meta);
            card.appendChild(p);
            card.appendChild(actions);
            card.appendChild(collapse);
            grid.appendChild(card);
          });

          seriesEl.appendChild(grid);
          container.appendChild(seriesEl);

          // toggle behaviour
          hdr.addEventListener('click', ()=> {
            const isVisible = grid.style.display === 'grid' || grid.style.display === 'block';
            // toggle
            grid.style.display = isVisible ? 'none' : 'grid';
            caret.textContent = isVisible ? '‚ñæ' : '‚ñ¥';
          });
          hdr.addEventListener('keypress', (e)=> { if(e.key==='Enter' || e.key===' ') hdr.click(); });

        }); // end series loop

        // SEARCH implementation
        const qInput = document.getElementById('q');
        const clearBtn = document.getElementById('clear');
        function performFilter(){
          const q = (qInput.value || '').trim().toLowerCase();
          const cards = container.querySelectorAll('.card');
          if(!q){
            cards.forEach(c => c.style.display='flex');
            // collapse all expanded content for clarity
            container.querySelectorAll('.collapse').forEach(c => c.style.display='none');
            container.querySelectorAll('.btn-read').forEach(b=>b.textContent='Read More ‚Üí');
            return;
          }
          cards.forEach(c=>{
            const title = (c.dataset.title||'').toLowerCase();
            const preview = (c.dataset.preview||'').toLowerCase();
            const match = title.includes(q) || preview.includes(q);
            c.style.display = match ? 'flex' : 'none';
          });
        }
        qInput.addEventListener('input', performFilter);
        qInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') performFilter(); });
        clearBtn.addEventListener('click', ()=>{ qInput.value=''; performFilter(); });

        // Expand / Collapse all
        document.getElementById('expandAll').addEventListener('click', ()=>{
          container.querySelectorAll('.blogs-row').forEach(g => g.style.display='grid');
          container.querySelectorAll('.collapse').forEach(c => c.style.display='block');
          container.querySelectorAll('.btn-read').forEach(b => b.textContent='Hide');
        });
        document.getElementById('collapseAll').addEventListener('click', ()=>{
          container.querySelectorAll('.blogs-row').forEach(g => g.style.display='none');
          container.querySelectorAll('.collapse').forEach(c => c.style.display='none');
          container.querySelectorAll('.btn-read').forEach(b => b.textContent='Read More ‚Üí');
        });

      }catch(err){
        status.textContent = 'Error loading posts.json ‚Äî check file exists and JSON is valid.';
        console.error(err);
      }
    }

    // expose search input globally for accessibility
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
