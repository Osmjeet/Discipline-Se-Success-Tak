 <!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blogs ‚Äî Discipline Se Success Tak</title>
  <meta name="description" content="Series-wise blogs by Jeet S Singh. Click Read to expand a post inline." />
  <style>
    :root{
      --accent:#0b8f76;
      --accent-dark:#06664f;
      --bg:#f7fffc;
      --card:#ffffff;
      --muted:#60786f;
      --text:#0b2f29;
      --radius:12px;
      --maxw:980px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, "Noto Sans Devanagari", system-ui, -apple-system, "Segoe UI", Roboto, Arial;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
    header{background:var(--accent-dark);color:#fff;padding:12px 18px;position:sticky;top:0;z-index:60}
    .nav{max-width:var(--maxw);margin:0 auto;display:flex;align-items:center;gap:18px;flex-wrap:wrap}
    .brand{font-weight:800}
    nav.links{margin-left:auto}
    nav.links a{color:#fff;text-decoration:none;margin-right:12px;font-weight:600}
    main{max-width:var(--maxw);margin:22px auto;padding:18px}
    .panel{background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:0 8px 22px rgba(6,18,16,0.04);border:1px solid #e7f6f0}
    .search{margin-bottom:16px;display:flex;gap:12px;align-items:center}
    .search input{flex:1;padding:12px 14px;border-radius:10px;border:1px solid #e5f4ed;font-size:15px}
    .search .filter{padding:10px 12px;border-radius:10px;border:1px solid #e5f4ed;background:#f6fffb;color:var(--accent-dark);font-weight:700}
    .series{margin-top:18px}
    .series .series-head{font-size:16px;color:var(--accent-dark);font-weight:800;margin:18px 6px}
    .list{margin-top:8px;display:flex;flex-direction:column;gap:12px}
    .item{display:flex;flex-wrap:wrap;gap:12px;padding:16px;border-radius:12px;border:1px solid #eef8f3;background:linear-gradient(180deg,#ffffff,#fbfffd);position:relative;align-items:flex-start}
    .info{flex:1;min-width:240px}
    .title{font-size:18px;color:var(--accent-dark);margin:0 0 8px 0;font-weight:700}
    .preview{color:var(--muted);line-height:1.6}
    .meta{font-size:13px;color:#9fb3aa;margin-top:8px}
    .actions{min-width:120px;display:flex;align-items:center;justify-content:flex-end}
    .read{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:700;cursor:pointer;border:0}
    .read:hover{background:var(--accent-dark)}
    .expanded-wrap{margin-top:16px;padding:0;text-align:center;width:100%}
    .expanded-card{max-width:820px;margin:10px auto 0 auto;text-align:left;padding:18px;border-radius:12px;background:#fff;border:1px solid #eef9f5;box-shadow:0 12px 40px rgba(6,18,16,0.05)}
    .expanded-card h3{margin:0 0 14px 0;color:var(--accent-dark)}
    .expanded-card .content{line-height:1.7;color:#123532}
    .byline{margin-top:18px;font-size:14px;color:var(--muted);font-weight:600}
    .note{color:var(--muted);font-size:13px;margin-top:10px}
    .no-posts{padding:22px;text-align:center;color:var(--muted)}
    footer{max-width:var(--maxw);margin:26px auto;text-align:center;color:var(--muted);font-size:14px}
    @media(max-width:800px){
      .actions{justify-content:flex-start;width:100%}
      .read{width:100%}
    }
  </style>
</head>
<body>

  <header>
    <div class="nav">
      <div class="brand">üìö Discipline Se Success Tak</div>
      <nav class="links">
        <a href="index.html">üè† Home</a>
        <a href="blog.html">üìù Blogs</a>
        <a href="author.html">üë§ Author</a>
        <a href="ebook.html">üìò Free eBook</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="panel" role="main" aria-live="polite">
      <div class="search" aria-label="Search and filter posts">
        <input id="q" placeholder="Search title or preview..." aria-label="Search blogs">
        <select id="seriesFilter" class="filter" aria-label="Filter by series">
          <option value="">All Series</option>
        </select>
      </div>

      <div id="container"></div>
      <div id="load-error" class="no-posts" style="display:none;margin-top:12px">
        Unable to load posts. Check <code>posts.json</code> path and content.
      </div>
    </div>
  </main>

  <footer>¬© 2025 Jeet S Singh ‚Äî Discipline ‚Ä¢ Faith ‚Ä¢ Success</footer>

<script>
/*
  Final blog.html with series grouping.
  Expects posts.json at same folder level and posts files referenced in it.
  posts.json items example:
  {
    "id": 11,
    "title": "Blog 11 ‚Äî Negativity ‡§ï‡•ã Identify ‡§ï‡§∞‡•ã",
    "preview": "...",
    "file": "posts/blog11.html",
    "series": "Series 2"
  }
*/

(function(){
  const POSTS_JSON = './posts.json';
  const container = document.getElementById('container');
  const errEl = document.getElementById('load-error');
  const qEl = document.getElementById('q');
  const seriesSelect = document.getElementById('seriesFilter');

  let posts = [];
  let expandedId = null;

  function uniqSeries(list){
    const s = Array.from(new Set(list.map(p => p.series || 'Series 1')));
    return s;
  }

  function groupBySeries(list){
    const groups = {};
    list.forEach(p=>{
      const key = p.series || 'Series 1';
      groups[key] = groups[key] || [];
      groups[key].push(p);
    });
    // keep series order as seen in original posts array
    const order = uniqSeries(list);
    return {groups, order};
  }

  function createItemNode(p){
    const item = document.createElement('div');
    item.className = 'item';
    item.dataset.id = p.id;

    const info = document.createElement('div');
    info.className = 'info';

    const title = document.createElement('div');
    title.className = 'title';
    title.textContent = p.title;

    const preview = document.createElement('div');
    preview.className = 'preview';
    preview.textContent = p.preview || '';

    const meta = document.createElement('div');
    meta.className = 'meta';
    meta.textContent = p.meta || '';

    info.appendChild(title);
    info.appendChild(preview);
    info.appendChild(meta);

    const actions = document.createElement('div');
    actions.className = 'actions';
    const read = document.createElement('button');
    read.className = 'read';
    read.textContent = 'Read';
    read.addEventListener('click', ()=>toggleExpand(p, item));
    actions.appendChild(read);

    item.appendChild(info);
    item.appendChild(actions);
    return item;
  }

  function render(groupsObj){
    container.innerHTML = '';
    const {groups, order} = groupsObj;
    if(order.length === 0){
      container.innerHTML = '<div class="no-posts">No posts available.</div>';
      return;
    }

    order.forEach(seriesName=>{
      const seriesList = groups[seriesName];
      if(!seriesList || seriesList.length===0) return;
      const sec = document.createElement('section');
      sec.className = 'series';
      const head = document.createElement('div');
      head.className = 'series-head';
      head.textContent = seriesName;
      sec.appendChild(head);

      const list = document.createElement('div');
      list.className = 'list';

      seriesList.forEach(p=>{
        const item = createItemNode(p);
        list.appendChild(item);
        // if was expanded, re-open
        if(String(p.id) === String(expandedId)){
          loadIntoItem(p, item);
        }
      });

      sec.appendChild(list);
      container.appendChild(sec);
    });
  }

  function collapseCurrent(){
    if(!expandedId) return;
    const prev = container.querySelector('.item[data-id="'+expandedId+'"]');
    if(prev){
      const ex = prev.querySelector('.expanded-wrap');
      if(ex) ex.remove();
      const btn = prev.querySelector('.read');
      if(btn) btn.textContent = 'Read';
      prev.style.boxShadow = 'none';
    }
    expandedId = null;
  }

  function toggleExpand(post, itemNode){
    if(String(expandedId) === String(post.id)){
      collapseCurrent();
      return;
    }
    collapseCurrent();
    // add small highlight
    container.querySelectorAll('.item').forEach(n=>n.style.boxShadow='none');
    itemNode.style.boxShadow = '0 10px 30px rgba(11,143,118,0.06)';
    const btn = itemNode.querySelector('.read');
    if(btn) btn.textContent = 'Loading...';
    loadIntoItem(post, itemNode);
  }

  function loadIntoItem(post, itemNode){
    fetch(post.file).then(r=>{
      if(!r.ok) throw new Error('file-not-found');
      return r.text();
    }).then(html=>{
      const wrap = document.createElement('div');
      wrap.className = 'expanded-wrap';
      const card = document.createElement('div');
      card.className = 'expanded-card';

      const h = document.createElement('h3');
      h.textContent = post.title;
      const content = document.createElement('div');
      content.className = 'content';
      // the loaded html might contain full doc; if it's full html, we should extract body inner.
      // Simple heuristic: if contains <body>, extract between <body> tags
      let parsed = html;
      const bodyMatch = html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);
      if(bodyMatch && bodyMatch[1]) parsed = bodyMatch[1];
      content.innerHTML = parsed;

      // Byline
      const by = document.createElement('div');
      by.className = 'byline';
      by.textContent = '‚Äî Written by Jeet S Singh, Author of "Discipline Se Success Tak"';

      card.appendChild(h);
      card.appendChild(content);
      card.appendChild(by);
      wrap.appendChild(card);

      // remove existing expanded or error nodes inside this item
      const existing = itemNode.querySelector('.expanded-wrap');
      if(existing) existing.remove();
      const err = itemNode.querySelector('.err-inline');
      if(err) err.remove();

      // insert before actions (so card appears below preview)
      itemNode.appendChild(wrap);
      expandedId = post.id;
      const btn = itemNode.querySelector('.read');
      if(btn) btn.textContent = 'Close';
      // smooth scroll to expanded card
      setTimeout(()=>{ wrap.scrollIntoView({behavior:'smooth', block:'center'}); }, 50);
    }).catch(err=>{
      // show inline error
      const em = document.createElement('div');
      em.className = 'err-inline';
      em.style.color = '#c0392b';
      em.style.marginTop = '12px';
      em.textContent = 'Unable to load post. Check file path: '+post.file;
      const existing = itemNode.querySelector('.expanded-wrap');
      if(existing) existing.remove();
      itemNode.appendChild(em);
      const btn = itemNode.querySelector('.read');
      if(btn) btn.textContent = 'Read';
      expandedId = null;
    });
  }

  // build series select options
  function populateSeriesSelect(uniqueSeries){
    // clear and add All
    seriesSelect.innerHTML = '<option value="">All Series</option>';
    uniqueSeries.forEach(s=>{
      const opt = document.createElement('option');
      opt.value = s;
      opt.textContent = s;
      seriesSelect.appendChild(opt);
    });
  }

  // render based on filters: search & series filter
  function renderFiltered(){
    const q = qEl.value.trim().toLowerCase();
    const sfilter = seriesSelect.value;
    let filtered = posts.slice();
    if(sfilter) filtered = filtered.filter(p => (p.series || 'Series 1') === sfilter);
    if(q){
      filtered = filtered.filter(p => ((p.title||'')+' '+(p.preview||'')).toLowerCase().includes(q));
    }
    const grouped = groupBySeries(filtered);
    render(grouped);
  }

  // initial load
  fetch(POSTS_JSON).then(r=>{
    if(!r.ok) throw new Error('missing posts.json');
    return r.json();
  }).then(data=>{
    if(!Array.isArray(data)) throw new Error('invalid posts.json');
    // sort by id ascending for stable order
    posts = data.slice().sort((a,b)=> (Number(a.id) || 0) - (Number(b.id) || 0) );
    const unique = uniqSeries(posts);
    populateSeriesSelect(unique);
    renderFiltered();
    errEl.style.display = 'none';
  }).catch(e=>{
    console.error(e);
    errEl.style.display = 'block';
    container.innerHTML = '';
  });

  // events
  qEl.addEventListener('input', ()=>{
    collapseCurrent();
    renderFiltered();
  });
  seriesSelect.addEventListener('change', ()=>{
    collapseCurrent();
    renderFiltered();
  });

})();
</script>

</body>
</html>
