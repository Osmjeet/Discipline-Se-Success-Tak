<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Discipline Se Success Tak ‚Äî Series-wise Blogs</title>
  <meta name="description" content="Series-wise blog list ‚Äî click a post to expand inline. Use posts.json in repo root and posts/*.html files for content."/>
  <style>
    :root{
      --accent:#0b8f76;
      --accent-2:#06664f;
      --muted:#6b7a75;
      --bg:#f6fffb;
      --card:#ffffff;
      --text:#083731;
      --soft:#e9faf5;
      --radius:14px;
      --maxw:980px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, "Noto Sans Devanagari", system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:linear-gradient(180deg,#f8fffb,#f0fcf8); color:var(--text); -webkit-font-smoothing:antialiased;}
    header{background:var(--accent-2);color:#fff;padding:12px 18px;position:sticky;top:0;z-index:100;box-shadow:0 4px 12px rgba(6,16,14,0.08)}
    .nav{max-width:var(--maxw);margin:0 auto;display:flex;align-items:center;gap:14px;flex-wrap:wrap}
    .brand{font-weight:700;display:flex;gap:12px;align-items:center}
    .brand img{height:30px;border-radius:4px}
    nav a{color:#fff;text-decoration:none;font-weight:600;font-size:15px;opacity:.96}
    nav a:hover{opacity:1}
    main{max-width:var(--maxw);margin:26px auto;padding:18px}
    .panel{background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:0 10px 30px rgba(6,20,18,0.04);border:1px solid #e9fbf5}
    .top-search{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .search{flex:1;min-width:240px}
    .search input{width:100%;padding:14px 16px;border-radius:12px;border:1px solid #dff4ec;background:transparent;font-size:15px}
    .series-list{margin-top:18px}
    .series-btn{display:flex;justify-content:space-between;align-items:center;padding:14px;border-radius:12px;background:var(--soft);border:1px solid #e2f6ef;margin-bottom:10px;cursor:pointer}
    .series-btn h3{margin:0;font-size:16px;color:var(--accent-2)}
    .series-count{color:var(--muted);font-weight:700}
    .cards{margin-top:12px}
    .card-row{display:flex;gap:18px;align-items:flex-start;flex-wrap:wrap;margin-bottom:14px;border-radius:12px;padding:12px;border:1px solid #eef8f4;background:#fff}
    .card-left{flex:1;min-width:240px}
    .card-right{width:360px;max-width:45%;min-width:220px}
    .card-title{font-size:18px;color:var(--accent-2);margin:0 0 8px 0}
    .card-preview{color:var(--muted);font-size:15px;line-height:1.6}
    .meta{margin-top:8px;color:#9aa9a3;font-size:13px}
    .read-btn{display:inline-block;background:var(--accent);color:#fff;padding:8px 14px;border-radius:12px;text-decoration:none;font-weight:700;box-shadow:0 8px 16px rgba(11,143,118,0.12)}
    .read-btn:hover{background:var(--accent-2)}
    .inline-post{margin-top:12px;padding:16px;border-radius:12px;background:linear-gradient(180deg,#ffffff,#fbfff9);border:1px solid #e6f7ef}
    .inline-post h2{margin-top:0;color:var(--accent-2)}
    .note{color:var(--muted);font-size:14px;margin-top:12px}
    .err{color:#c0392b;font-weight:700;margin-top:12px}
    .preview-list{margin-top:18px}
    .highlight{outline:4px solid rgba(11,143,118,0.08);box-shadow:0 8px 18px rgba(6,20,18,0.04)}
    footer{max-width:var(--maxw);margin:28px auto;text-align:center;color:var(--muted);font-size:14px}
    /* responsive */
    @media(max-width:900px){
      .card-right{width:100%;max-width:100%}
      .card-row{flex-direction:column}
    }
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand">
        <span style="font-size:18px">üìö</span>
        <div>
          <div style="font-weight:800">Discipline Se Success Tak</div>
          <div style="font-size:12px;opacity:.9">Series-wise Blogs ‚Äî Click to expand inline</div>
        </div>
      </div>
      <div style="margin-left:auto;display:flex;gap:14px;align-items:center">
        <nav>
          <a href="index.html">üè† Home</a> &nbsp; <a href="blog.html">üìù Blogs</a> &nbsp; <a href="author.html">üë§ Author</a> &nbsp; <a href="ebook.html">üìò Free eBook</a>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <section class="panel" aria-labelledby="series-heading">
      <div class="top-search">
        <div class="search">
          <input id="search" placeholder="Search blogs by title or preview..." aria-label="Search blogs by title or preview">
        </div>
      </div>

      <div id="series-container" class="series-list" aria-live="polite">
        <!-- Series accordion generated by JS -->
      </div>

      <div id="error" class="err" role="alert" style="display:none">Unable to load blogs. Check <code>posts.json</code> path and file.</div>
    </section>

    <section id="posts-output" style="margin-top:20px">
      <!-- Expanded post content will appear here -->
    </section>
  </main>

  <footer>
    ¬© 2025 Jeet S Singh ‚Äî Discipline ‚Ä¢ Faith ‚Ä¢ Success
  </footer>

<script>
(function(){
  const POSTS_JSON = './posts.json'; // ensure file at repo root
  const seriesContainer = document.getElementById('series-container');
  const output = document.getElementById('posts-output');
  const searchEl = document.getElementById('search');
  const errorEl = document.getElementById('error');
  let posts = [];

  // helper: group by series preserving order
  function groupBySeries(arr){
    const map = new Map();
    for(const p of arr){
      const s = p.series || 'Uncategorized';
      if(!map.has(s)) map.set(s, []);
      map.get(s).push(p);
    }
    return Array.from(map.entries()); // [ [seriesName, [posts...]], ... ]
  }

  function createSeriesNode(seriesName, items){
    const wrapper = document.createElement('div');
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'series-btn';
    btn.setAttribute('aria-expanded','false');

    const h = document.createElement('h3');
    h.textContent = seriesName;
    const c = document.createElement('div');
    c.className = 'series-count';
    c.textContent = `(${items.length})`;

    btn.appendChild(h);
    btn.appendChild(c);

    const cardsWrap = document.createElement('div');
    cardsWrap.className = 'cards';
    cardsWrap.style.display = 'none';
    cardsWrap.setAttribute('data-series', seriesName);

    // create cards
    items.forEach(p => {
      const row = document.createElement('div');
      row.className = 'card-row';
      row.setAttribute('data-id', p.id);
      // left
      const left = document.createElement('div');
      left.className = 'card-left';
      const title = document.createElement('div');
      title.className = 'card-title';
      title.textContent = p.title;
      const preview = document.createElement('div');
      preview.className = 'card-preview';
      preview.textContent = p.preview;
      const meta = document.createElement('div');
      meta.className = 'meta';
      meta.textContent = `ID: ${p.id} ‚Äî File: ${p.file}`;
      left.appendChild(title);
      left.appendChild(preview);
      left.appendChild(meta);

      // right
      const right = document.createElement('div');
      right.className = 'card-right';
      const readBtn = document.createElement('a');
      readBtn.href = '#';
      readBtn.className = 'read-btn';
      readBtn.textContent = 'Read';
      readBtn.addEventListener('click', (e)=>{
        e.preventDefault();
        // remove existing highlights
        document.querySelectorAll('.card-row').forEach(n=>n.classList.remove('highlight'));
        row.classList.add('highlight');
        loadPostInline(p);
      });

      right.appendChild(readBtn);

      row.appendChild(left);
      row.appendChild(right);
      cardsWrap.appendChild(row);
    });

    btn.addEventListener('click', ()=>{
      const visible = cardsWrap.style.display !== 'none';
      // collapse any other open series? keep independent ‚Äî but we toggle btn aria
      cardsWrap.style.display = visible ? 'none' : 'block';
      btn.setAttribute('aria-expanded', visible ? 'false' : 'true');
      // scroll into view a bit for better mobile UX
      if(!visible) btn.scrollIntoView({behavior:'smooth',block:'start'});
    });

    wrapper.appendChild(btn);
    wrapper.appendChild(cardsWrap);
    return wrapper;
  }

  function renderSeries(list){
    seriesContainer.innerHTML = '';
    if(!list.length){
      seriesContainer.innerHTML = '<div class="note">No blogs found.</div>';
      return;
    }
    list.forEach(([seriesName, items])=>{
      seriesContainer.appendChild(createSeriesNode(seriesName, items));
    });
  }

  function loadPostInline(post){
    // clear previous output and fetch file
    output.innerHTML = '';
    const container = document.createElement('div');
    container.className = 'panel inline-post';
    const loading = document.createElement('div');
    loading.textContent = 'Loading post...';
    loading.className = 'note';
    container.appendChild(loading);
    output.appendChild(container);
    // fetch the post file (relative)
    fetch(post.file).then(res=>{
      if(!res.ok) throw new Error('Not found');
      return res.text();
    }).then(html=>{
      container.innerHTML = '';
      // insert a heading & author line like previous posts
      const h = document.createElement('h2');
      h.textContent = post.title;
      container.appendChild(h);
      // add small author / written by line
      const byline = document.createElement('div');
      byline.className = 'meta';
      byline.textContent = `Written by Jeet S Singh ‚Äî Author of "Discipline Se Success Tak"`;
      container.appendChild(byline);
      // insert fetched html safely
      const contentWrapper = document.createElement('div');
      contentWrapper.innerHTML = html;
      // ensure images / links keep relative behaviour
      container.appendChild(contentWrapper);
      // smooth scroll to the post container top
      container.scrollIntoView({behavior:'smooth',block:'start'});
    }).catch(err=>{
      container.innerHTML = '';
      const em = document.createElement('div');
      em.className = 'err';
      em.textContent = 'Unable to load post content. Check file path: ' + post.file;
      container.appendChild(em);
    });
  }

  // search
  function applySearch(q){
    q = q.trim().toLowerCase();
    if(!q){
      const grouped = groupBySeries(posts);
      renderSeries(grouped);
      return;
    }
    // filter posts where title or preview contains query
    const filtered = posts.filter(p => (p.title + ' ' + p.preview).toLowerCase().includes(q));
    const grouped = groupBySeries(filtered);
    renderSeries(grouped);
  }

  // initial fetch posts.json
  fetch(POSTS_JSON).then(r=>{
    if(!r.ok) throw new Error('posts.json missing');
    return r.json();
  }).then(data=>{
    if(!Array.isArray(data)) throw new Error('posts.json must be an array');
    posts = data.sort((a,b)=> (a.id||0) - (b.id||0)); // sort by id for consistent order
    const grouped = groupBySeries(posts);
    renderSeries(grouped);
    errorEl.style.display = 'none';
  }).catch(err=>{
    console.error(err);
    errorEl.style.display = 'block';
  });

  // events
  searchEl.addEventListener('input', e => applySearch(e.target.value));

  // keyboard: pressing enter on search focuses first read button if any visible
  searchEl.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){
      const firstRead = document.querySelector('.read-btn');
      if(firstRead) { firstRead.focus(); firstRead.click(); }
    }
  });

})();
</script>
</body>
</html>
